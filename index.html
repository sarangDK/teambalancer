<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LoL íŒ€ ë°¸ëŸ°ì„œ</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
      color: #fff;
    }
    h1, h2, h3 {
      text-align: center;
      color: #00bfff;
    }
    input, select, button {
      margin: 5px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      font-size: 14px;
    }
    input, select {
      width: 140px;
    }
    button {
      background-color: #222;
      color: #0ff;
      cursor: pointer;
      box-shadow: 0 0 10px #0ff;
      transition: 0.3s;
    }
    button:hover {
      background-color: #0ff;
      color: #000;
    }
    #playerList, #teamA, #teamB, #filteredResult {
      list-style: none;
      padding-left: 0;
    }
    .team {
      background-color: #121212;
      border-radius: 12px;
      margin-top: 20px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(0,255,255,0.3);
    }
    .team h2 {
      color: #ff4444;
    }
    .blue h2 {
      color: #44aaff;
    }
    .player-list li, .team li {
      margin: 4px 0;
    }
    .delete-btn {
      margin-left: 10px;
      background: #ff4444;
      border-radius: 4px;
      color: white;
      padding: 2px 6px;
      font-size: 12px;
      cursor: pointer;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .filter-box {
      margin-top: 40px;
      text-align: center;
    }
    .team ul li {
  animation: fadeInUp 0.5s ease both;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
button:active {
  transform: scale(0.95);
  box-shadow: 0 0 5px #0ff;
}






  </style>
</head>
<body>
  <h1>ğŸ® LoL íŒ€ ë°¸ëŸ°ì„œ</h1>

  <div class="controls">
    <input type="text" id="name" placeholder="ë‹‰ë„¤ì„" />
    <select id="tier">
      <option value="ë§ˆê·¸ì±Œ900+">ë§ˆ/ê·¸/ì±Œ 900 ì´ìƒ</option>
      <option value="ë§ˆê·¸ì±Œ750">ë§ˆ/ê·¸/ì±Œ 750~899</option>
      <option value="ë§ˆê·¸ì±Œ600">ë§ˆ/ê·¸/ì±Œ 600~749</option>
      <option value="ë§ˆê·¸ì±Œ450">ë§ˆ/ê·¸/ì±Œ 450~599</option>
      <option value="ë§ˆê·¸ì±Œ300">ë§ˆ/ê·¸/ì±Œ 300~449</option>
      <option value="ë§ˆê·¸ì±Œ150">ë§ˆ/ê·¸/ì±Œ 150~299</option>
      <option value="ë§ˆê·¸ì±Œ0">ë§ˆ/ê·¸/ì±Œ 0~149</option>
      <option value="ë‹¤ì´ì•„1">ë‹¤ì´ì•„1</option>
      <option value="ë‹¤ì´ì•„2">ë‹¤ì´ì•„2</option>
      <option value="ì—ë©”ë„ë“œ+ë‹¤ì´ì•„">ì—ë©”ë„ë“œ+ë‹¤ì´ì•„</option>
      <option value="ì—ë©”ë„ë“œ">ì—ë©”ë„ë“œ</option>
      <option value="í”Œë ˆ1">í”Œë˜í‹°ë„˜1</option>
      <option value="í”Œë ˆ2">í”Œë˜í‹°ë„˜2</option>
      <option value="í”Œë ˆ3">í”Œë˜í‹°ë„˜3</option>
      <option value="í”Œë ˆ4">í”Œë˜í‹°ë„˜4</option>
      <option value="ê³¨ë“œ1">ê³¨ë“œ1</option>
      <option value="ê³¨ë“œ2">ê³¨ë“œ2</option>
      <option value="ê³¨ë“œ3">ê³¨ë“œ3</option>
      <option value="ê³¨ë“œ4">ê³¨ë“œ4</option>
      <option value="ì‹¤ë²„1">ì‹¤ë²„1</option>
      <option value="ì‹¤ë²„2">ì‹¤ë²„2</option>
      <option value="ì‹¤ë²„3">ì‹¤ë²„3</option>
      <option value="ì‹¤ë²„4">ì‹¤ë²„4</option>
      <option value="ë¸Œë¡ ì¦ˆ">ë¸Œë¡ ì¦ˆ ì´í•˜</option>
    </select>
    <select id="lane1">
      <option value="ìƒê´€ì—†ìŒ">ìƒê´€ì—†ìŒ</option>
      <option value="íƒ‘">íƒ‘</option>
      <option value="ì •ê¸€">ì •ê¸€</option>
      <option value="ë¯¸ë“œ">ë¯¸ë“œ</option>
      <option value="ì›ë”œ">ì›ë”œ</option>
      <option value="ì„œí¿">ì„œí¿</option>
    </select>
    <select id="lane2">
      <option value="ìƒê´€ì—†ìŒ">ìƒê´€ì—†ìŒ</option>
      <option value="íƒ‘">íƒ‘</option>
      <option value="ì •ê¸€">ì •ê¸€</option>
      <option value="ë¯¸ë“œ">ë¯¸ë“œ</option>
      <option value="ì›ë”œ">ì›ë”œ</option>
      <option value="ì„œí¿">ì„œí¿</option>
    </select>
    <button onclick="addPlayer()">ì¶”ê°€</button>
    <button onclick="clearPlayers()">ì´ˆê¸°í™”</button>
  </div>

  <ul id="playerList" class="player-list"></ul>
  <button onclick="generateTeams()">íŒ€ ìë™ ìƒì„±</button>

  <div class="team blue">
    <h2>ğŸ”µ ë¸”ë£¨ íŒ€</h2>
    <ul id="teamA" style="border: 1px solid #44aaff; padding: 10px; border-radius: 8px;"></ul>
    <p id="scoreA"></p>
  </div>
  
  <div class="team">
    <h2>ğŸ”´ ë ˆë“œ íŒ€</h2>
    <ul id="teamB" style="border: 1px solid #ff4444; padding: 10px; border-radius: 8px;"></ul>
    <p id="scoreB"></p>
  </div>
  
  <div style="text-align:center; margin-top: 10px;">
    <button onclick="generateTeams()">ğŸ” íŒ€ ë‹¤ì‹œ ì„ê¸°</button>
  </div>
  
  <div style="text-align:center; margin-top: 20px;">
    <button onclick="declareWinner('A')">ğŸ”µ ë¸”ë£¨ íŒ€ ìŠ¹ë¦¬</button>
    <button onclick="declareWinner('B')">ğŸ”´ ë ˆë“œ íŒ€ ìŠ¹ë¦¬</button>
  </div>


  </div>
  

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDp3Vr0l_WbvENgSuPAiN_zfzDTwYzYFzU",
      authDomain: "teambalancer-7720c.firebaseapp.com",
      projectId: "teambalancer-7720c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  
    const emoji = { íƒ‘: "ğŸ”", ì •ê¸€: "ğŸŒ²", ë¯¸ë“œ: "ğŸ§ ", ì›ë”œ: "ğŸ¯", ì„œí¿: "ğŸ›¡ï¸", ìƒê´€ì—†ìŒ: "ğŸ²", ë¯¸ì •: "ğŸ²" };
  
   const scoreTable = {
          "ë§ˆê·¸ì±Œ900+": { íƒ‘: 56, ì •ê¸€: 64, ë¯¸ë“œ: 62, ì›ë”œ: 58, ì„œí¿: 54 },
          "ë§ˆê·¸ì±Œ750": { íƒ‘: 54, ì •ê¸€: 62, ë¯¸ë“œ: 60, ì›ë”œ: 56, ì„œí¿: 52 },
          "ë§ˆê·¸ì±Œ600": { íƒ‘: 52, ì •ê¸€: 60, ë¯¸ë“œ: 57, ì›ë”œ: 53, ì„œí¿: 50 },
          "ë§ˆê·¸ì±Œ450": { íƒ‘: 50, ì •ê¸€: 58, ë¯¸ë“œ: 54, ì›ë”œ: 50, ì„œí¿: 48 },
          "ë§ˆê·¸ì±Œ300": { íƒ‘: 48, ì •ê¸€: 55, ë¯¸ë“œ: 52, ì›ë”œ: 47, ì„œí¿: 45 },
          "ë§ˆê·¸ì±Œ150": { íƒ‘: 46, ì •ê¸€: 52, ë¯¸ë“œ: 50, ì›ë”œ: 45, ì„œí¿: 42 },
          "ë§ˆê·¸ì±Œ0":   { íƒ‘: 43, ì •ê¸€: 49, ë¯¸ë“œ: 48, ì›ë”œ: 42, ì„œí¿: 40 },
          "ë‹¤ì´ì•„1":   { íƒ‘: 40, ì •ê¸€: 45, ë¯¸ë“œ: 42, ì›ë”œ: 40, ì„œí¿: 38 },
          "ë‹¤ì´ì•„2":   { íƒ‘: 34, ì •ê¸€: 38, ë¯¸ë“œ: 39, ì›ë”œ: 33, ì„œí¿: 32 },
          "ì—ë©”ë„ë“œ+ë‹¤ì´ì•„": { íƒ‘: 30, ì •ê¸€: 36, ë¯¸ë“œ: 38, ì›ë”œ: 31, ì„œí¿: 30 },
          "ì—ë©”ë„ë“œ":   { íƒ‘: 28, ì •ê¸€: 32, ë¯¸ë“œ: 37, ì›ë”œ: 28, ì„œí¿: 27 },
          "í”Œë ˆ1":     { íƒ‘: 26, ì •ê¸€: 30, ë¯¸ë“œ: 29, ì›ë”œ: 25, ì„œí¿: 24 },
          "í”Œë ˆ2":     { íƒ‘: 25, ì •ê¸€: 28, ë¯¸ë“œ: 27, ì›ë”œ: 24, ì„œí¿: 22 },
          "í”Œë ˆ3":     { íƒ‘: 23, ì •ê¸€: 26, ë¯¸ë“œ: 24, ì›ë”œ: 22, ì„œí¿: 21 },
          "í”Œë ˆ4":     { íƒ‘: 22, ì •ê¸€: 23, ë¯¸ë“œ: 22, ì›ë”œ: 20, ì„œí¿: 19 },
          "ê³¨ë“œ1":     { íƒ‘: 21, ì •ê¸€: 18, ë¯¸ë“œ: 17, ì›ë”œ: 18, ì„œí¿: 21 },
          "ê³¨ë“œ2":     { íƒ‘: 20, ì •ê¸€: 16, ë¯¸ë“œ: 16, ì›ë”œ: 17, ì„œí¿: 20 },
          "ê³¨ë“œ3":     { íƒ‘: 19, ì •ê¸€: 14, ë¯¸ë“œ: 15, ì›ë”œ: 16, ì„œí¿: 18 },
          "ê³¨ë“œ4":     { íƒ‘: 17, ì •ê¸€: 12, ë¯¸ë“œ: 13, ì›ë”œ: 14, ì„œí¿: 17 },
          "ì‹¤ë²„1":     { íƒ‘: 15, ì •ê¸€: 10, ë¯¸ë“œ: 12, ì›ë”œ: 10, ì„œí¿: 15 },
          "ì‹¤ë²„2":     { íƒ‘: 13, ì •ê¸€: 8,  ë¯¸ë“œ: 10, ì›ë”œ: 8,  ì„œí¿: 13 },
          "ì‹¤ë²„3":     { íƒ‘: 11, ì •ê¸€: 6,  ë¯¸ë“œ: 7,  ì›ë”œ: 7,  ì„œí¿: 11 },
          "ì‹¤ë²„4":     { íƒ‘: 9,  ì •ê¸€: 4,  ë¯¸ë“œ: 5,  ì›ë”œ: 5,  ì„œí¿: 9 },
          "ë¸Œë¡ ì¦ˆ":    { íƒ‘: 5,  ì •ê¸€: 2,  ë¯¸ë“œ: 3,  ì›ë”œ: 2,  ì„œí¿: 4 }
        };
    
  
    const players = JSON.parse(localStorage.getItem('players') || '[]');
    renderPlayerList();
  
    function addPlayer() {
  const name = document.getElementById('name').value.trim();
  const tier = document.getElementById('tier').value;
  const lane1 = document.getElementById('lane1').value;
  const lane2 = document.getElementById('lane2').value;

  const role = lane1 !== "ìƒê´€ì—†ìŒ" ? lane1 : "ë¯¸ì •";
  let score = 0;

  if (scoreTable[tier]) {
    if (role !== "ë¯¸ì •") {
      // ë©”ì¸ í¬ì§€ì…˜ ì ìˆ˜
      score = scoreTable[tier][role];
    } else if (lane2 !== "ìƒê´€ì—†ìŒ") {
      // ì„œë¸Œ í¬ì§€ì…˜ ì ìˆ˜ë¡œ ê³„ì‚°
      score = scoreTable[tier][lane2];
    } else {
      // í‰ê·  ì ìˆ˜ ê³„ì‚°
      const values = Object.values(scoreTable[tier]);
      score = Math.round(values.reduce((a, b) => a + b, 0) / values.length);
    }
  }

  players.push({ name, tier, score, role, sub: lane2, win: 0, lose: 0 });
  saveToLocal();
  renderPlayerList();
}

    function renderPlayerList() {
      const list = document.getElementById('playerList');
      list.innerHTML = '';
      players.forEach((p, i) => {
        const item = document.createElement('li');
        const winRate = (p.win + p.lose > 0) ? ` | ìŠ¹ë¥ : ${Math.round((p.win / (p.win + p.lose)) * 100)}%` : '';
        item.textContent = `${emoji[p.role] || ''} ${p.name} (${p.tier}, ${p.role}${p.sub ? ' / ' + p.sub : ''}) - ${p.score}ì  | ìŠ¹: ${p.win} íŒ¨: ${p.lose}${winRate}`;
        const edit = document.createElement('span');
        edit.textContent = 'âœï¸';
        edit.className = 'delete-btn';
        edit.onclick = () => editPlayer(i);
        const del = document.createElement('span');
        del.textContent = 'âŒ';
        del.className = 'delete-btn';
        del.onclick = () => { players.splice(i, 1); saveToLocal(); renderPlayerList(); };
        item.appendChild(edit);
        item.appendChild(del);
        list.appendChild(item);
      });
    }
  
    function editPlayer(index) {
      const p = players[index];
      document.getElementById('name').value = p.name;
      document.getElementById('tier').value = p.tier;
      document.getElementById('lane1').value = p.role;
      document.getElementById('lane2').value = p.sub;
      players.splice(index, 1);
      saveToLocal();
      renderPlayerList();
    }
  
    function clearPlayers() {
      players.length = 0;
      saveToLocal();
      renderPlayerList();
      document.getElementById('teamA').innerHTML = '';
      document.getElementById('teamB').innerHTML = '';
      document.getElementById('scoreA').textContent = '';
      document.getElementById('scoreB').textContent = '';
    }
  
    let currentTeams = { A: [], B: [] };
  
   
  function generateTeams() {
    const shuffled = [...players].sort(() => Math.random() - 0.5).sort((a, b) => b.score - a.score);
    const teamA = [], teamB = [];
    let sumA = 0, sumB = 0;

    function canAdd(player, team) {
      const lanes = team.map(p => p.role);
      if (lanes.includes(player.role)) {
        if (player.sub && !lanes.includes(player.sub)) return true;
        return false;
      }
      return true;
    }

    for (const player of shuffled) {
      if (teamA.length < 5 && (sumA <= sumB || teamB.length >= 5) && canAdd(player, teamA)) {
        teamA.push(player);
        sumA += player.score;
      } else if (teamB.length < 5 && canAdd(player, teamB)) {
        teamB.push(player);
        sumB += player.score;
      } else if (teamA.length < 5) {
        teamA.push(player);
        sumA += player.score;
      } else if (teamB.length < 5) {
        teamB.push(player);
        sumB += player.score;
      }
      if (teamA.length === 5 && teamB.length === 5) break;
    }

    currentTeams = { A: teamA, B: teamB };
    renderTeams(teamA, teamB, sumA, sumB);
  }



  const leftovers = players.filter(p => !usedNames.has(p.name));
  leftovers.sort(() => Math.random() - 0.5);
  let scoreA = teamA.reduce((s, p) => s + p.score, 0);
  let scoreB = teamB.reduce((s, p) => s + p.score, 0);

  leftovers.forEach(p => {
    if (scoreA <= scoreB) {
      teamA.push(p); scoreA += p.score;
    } else {
      teamB.push(p); scoreB += p.score;
    }
  });

  currentTeams = { A: teamA, B: teamB };
  renderTeams(teamA, teamB, scoreA, scoreB);


  
    function renderTeams(teamA, teamB, scoreA, scoreB) {
      const listA = document.getElementById('teamA');
      const listB = document.getElementById('teamB');
      listA.innerHTML = '';
      listB.innerHTML = '';
      teamA.forEach(p => {
        const li = document.createElement('li');
        li.textContent = `${emoji[p.role] || ''} ${p.name} (${p.role}${p.sub ? ' / ' + p.sub : ''}) - ${p.score}ì `;
        listA.appendChild(li);
      });
      teamB.forEach(p => {
        const li = document.createElement('li');
        li.textContent = `${emoji[p.role] || ''} ${p.name} (${p.role}${p.sub ? ' / ' + p.sub : ''}) - ${p.score}ì `;
        listB.appendChild(li);
      });
      document.getElementById('scoreA').textContent = `ì´ì : ${scoreA}`;
      document.getElementById('scoreB').textContent = `ì´ì : ${scoreB}`;
    }
  
    function savePlayersToFirebase() {
      players.forEach(p => {
        db.collection('players').add(p)
          .then(() => console.log(`âœ… ${p.name} ì €ì¥ë¨`))
          .catch(error => console.error(`âŒ ì €ì¥ ì‹¤íŒ¨: ${error}`));
      });
    }
  
    function saveToLocal() {
      localStorage.setItem('players', JSON.stringify(players));
    }
  
    function declareWinner(team) {
      const winTeam = currentTeams[team];
      const loseTeam = currentTeams[team === 'A' ? 'B' : 'A'];
      winTeam.forEach(p => {
        const found = players.find(pl => pl.name === p.name);
        if (found) found.win = (found.win || 0) + 1;
      });
      loseTeam.forEach(p => {
        const found = players.find(pl => pl.name === p.name);
        if (found) found.lose = (found.lose || 0) + 1;
      });
      saveToLocal();
      renderPlayerList();
    }
  </script>
</body>
</html>
